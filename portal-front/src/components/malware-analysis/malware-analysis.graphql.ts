import { graphql } from 'react-relay';

export const malwareAnalysisLoaderQuery = graphql`
  query malwareAnalysisQuery(
    $count: Int!
    $cursor: ID
    $orderBy: MalwareAnalysisOrdering!
    $orderMode: OrderingMode!
  ) {
    ...malwareAnalysisList_malwareAnalysis
  }
`;
export const malwareAnalysisFragment = graphql`
  fragment malwareAnalysis_fragment on MalwareAnalysis {
    id
    created_at
    type
    name
    ended_at
    result
    status
  }
`;

export const subscription = graphql`
  subscription malwareAnalysisListSubscription($connections: [ID!]!) {
    MalwareAnalysis {
      add
        @prependNode(
          connections: $connections
          edgeTypeName: "MalwareAnalysisEdge"
        ) {
        ...malwareAnalysis_fragment
      }
      edit {
        ...malwareAnalysis_fragment
      }
      delete {
        id @deleteRecord
      }
    }
  }
`;
export const malwareAnalysisListFragment = graphql`
  fragment malwareAnalysisList_malwareAnalysis on Query
  @refetchable(queryName: "MalwareAnalysisPaginationQuery") {
    malwareAnalysis(
      first: $count
      after: $cursor
      orderBy: $orderBy
      orderMode: $orderMode
    ) {
      __id
      totalCount
      edges {
        node {
          id
          ...malwareAnalysis_fragment @relay(mask: false)
        }
      }
    }
  }
`;

export const malwareAnalysis = graphql`
  mutation malwareAnalysisFormMutation($string: String, $file: Upload) {
    malwareAnalysis(string: $string, file: $file) {
      ...malwareAnalysis_fragment
    }
  }
`;
