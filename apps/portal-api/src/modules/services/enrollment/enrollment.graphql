enum OCTIPlatformContract {
  CE
  EE
}

type OCTIPlatform implements Node {
  id: ID!
  url: String!
  title: String!
  contract: OCTIPlatformContract!
  platform_id: String!
}

input OCTIPlatformInput {
  id: ID!
  url: String!
  title: String!
  contract: OCTIPlatformContract!
}

input EnrollOCTIPlatformInput {
  organizationId: ID!
  platform: OCTIPlatformInput!
}

input CanUnenrollOCTIPlatformInput {
  platformId: String!
}

type EnrollmentResponse {
  token: String!
}

enum PlatformRegistrationStatus {
  registered
  unregistered
  never_registered
}

input IsOCTIPlatformRegisteredInput {
  platformId: String!
}

type IsOCTIPlatformRegisteredResponse {
  status: PlatformRegistrationStatus!
  organizationId: ID
}

type CanUnenrollResponse {
  isPlatformEnrolled: Boolean!
  isAllowed: Boolean
  organizationId: ID
}

input UnenrollOCTIPlatformInput {
  platformId: String!
}

input OCTIPlatformEnrollmentStatusInput {
  platformId: String!
  token: String!
}

enum OCTIPlatformEnrollmentStatus {
  active
  inactive
}

type OCTIPlatformEnrollmentStatusResponse {
  status: OCTIPlatformEnrollmentStatus!
}

type Query {
  isOCTIPlatformRegistered(
    input: IsOCTIPlatformRegisteredInput!
  ): IsOCTIPlatformRegisteredResponse!
  canUnenrollOCTIPlatform(
    input: CanUnenrollOCTIPlatformInput!
  ): CanUnenrollResponse!
  octiPlatforms: [OCTIPlatform!]! @auth
  octiPlatformEnrollmentStatus(
    input: OCTIPlatformEnrollmentStatusInput!
  ): OCTIPlatformEnrollmentStatusResponse!
}

type Mutation {
  enrollOCTIPlatform(input: EnrollOCTIPlatformInput!): EnrollmentResponse!
    @auth(requires: [ADMINISTRATE_ORGANIZATION, MANAGE_OCTI_ENROLLMENT])
  unenrollOCTIPlatform(input: UnenrollOCTIPlatformInput): Success!
    @auth(requires: [ADMINISTRATE_ORGANIZATION, MANAGE_OCTI_ENROLLMENT])
}
